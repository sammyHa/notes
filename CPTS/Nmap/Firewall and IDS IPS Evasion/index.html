
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../Tools/Powershell/">
      
      
        <link rel="next" href="../Nmap/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>Firewall and IDS IPS Evasion - Pentesting Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../styles/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="#00be98" data-md-color-accent="#007e65">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#references" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Pentesting Notes" class="md-header__button md-logo" aria-label="Pentesting Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pentesting Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Firewall and IDS IPS Evasion
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="#00be98" data-md-color-accent="#007e65"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="#00be98" data-md-color-accent="#007e65"  aria-label="switch to light mdoe"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="switch to light mdoe" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Pentesting Notes" class="md-nav__button md-logo" aria-label="Pentesting Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Pentesting Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to My Portfolio
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CPTS
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            CPTS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Getting%20Started/Web%20Enumeration%20Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Enumeration Overview
    
  </span>
  
    
  
  
    <span class="md-status md-status--['Completed']"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Getting%20Started/Types%20of%20Shells/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Types of Shells
    
  </span>
  
    
  
  
    <span class="md-status md-status--['Completed']"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Getting%20Started/Folder%20Structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Folder Structure
    
  </span>
  
    
  
  
    <span class="md-status md-status--['In-Progress']"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Getting%20Started/Public%20Exploits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Public Exploits
    
  </span>
  
    
  
  
    <span class="md-status md-status--['Completed']"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Getting%20Started/Get%20OS%20Information/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get OS Information
    
  </span>
  
    
  
  
    <span class="md-status md-status--['Completed']"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Getting%20Started/Way%20Forward/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Way Forward
    
  </span>
  
    
  
  
    <span class="md-status md-status--['in-progress']"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Getting%20Started/Starting%20Out/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Starting Out
    
  </span>
  
    
  
  
    <span class="md-status md-status--['Completed']"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Getting%20Started/Common%20Pitfalls%20and%20Troubleshooting%20in%20VPN%20and%20SSH%20Connections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common Pitfalls and Troubleshooting in VPN and SSH Connections
    
  </span>
  
    
  
  
    <span class="md-status md-status--['Completed']"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Getting%20Started/Transferring%20Files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transferring Files
    
  </span>
  
    
  
  
    <span class="md-status md-status--['in-progress']"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    File Transfers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            File Transfers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../File%20Transfers/Win%20File%20Transfer%20Methods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Win File Transfer Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../File%20Transfers/Linux%20File%20Transfer%20Methods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux File Transfer Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../File%20Transfers/file_transfer_operations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File transfer operations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../File%20Transfers/transfer_files_wtih_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transferring Files with Code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../File%20Transfers/miscellaneous_file_transfer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Miscellaneous file transfer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../File%20Transfers/protected_file_transfer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protected file transfer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../File%20Transfers/catching_files_over_HTTPS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    catching files over HTTPS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../File%20Transfers/detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Detection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../File%20Transfers/living_off_the_land/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Living off the land
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../File%20Transfers/evasion_detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evasion detection
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Shells and Payloads
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Shells and Payloads
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Shells%20and%20Payloads/understanding_shells_and_payloads/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understanding Shells and Payloads
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Shells%20and%20Payloads/CAT5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CAT5 Security's Engagement Preparation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Shells%20and%20Payloads/anatomy_of_a_shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anatomy of a shell
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Shells%20and%20Payloads/bind_shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bind shell
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Shells%20and%20Payloads/reverseshell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reverseshell
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Shells%20and%20Payloads/Payloads/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Payloads
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Shells%20and%20Payloads/Infiltrating-Unix-Linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infiltrating Unix Linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Shells%20and%20Payloads/SpawningInteractiveShells/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SpawningInteractiveShells
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Shells%20and%20Payloads/Laudanum%2C%20One%20Webshell%20to%20Rule%20Them%20All/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Laudanum, One Webshell to Rule Them All
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Shells%20and%20Payloads/skillAssessment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    skillAssessment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Shells%20and%20Payloads/DetectionAndPrevention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Detection &amp; Prevention Summary
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Metasploit
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Metasploit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Metasploit/Preface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preface
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/onesixtyone/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    onesixtyone
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Braa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Braa
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/WinRM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WinRM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Shodan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shodan
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/xfreerdp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xfreerdp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Nessus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nessus
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Metasploit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Nikto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nikto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Rsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rsync
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/snmpwalk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snmpwalk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Windows_Management_Instrumentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows Management Instrumentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/vnStat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vnStat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/DNSenum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNSenum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/OpenVAS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenVAS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/File%20Transfer%20tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Transfer tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/JtR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    John the Ripper (JtR) Comprehensive Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Certutil/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Certutil
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/ssti/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A Pentester's Guide to Server-Side Template Injection (SSTI)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Powershell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Powershell
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" checked>
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Nmap
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Nmap
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Firewall and IDS IPS Evasion
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Firewall and IDS IPS Evasion
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#firewall-and-idsips-evasion-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      Firewall and IDS/IPS Evasion Techniques
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Firewall and IDS/IPS Evasion Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-understanding-firewalls" class="md-nav__link">
    <span class="md-ellipsis">
      1. Understanding Firewalls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-ids-vs-ips" class="md-nav__link">
    <span class="md-ellipsis">
      2. IDS vs. IPS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-identifying-firewalls-and-rules" class="md-nav__link">
    <span class="md-ellipsis">
      3. Identifying Firewalls and Rules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-firewall-evasion-with-nmap" class="md-nav__link">
    <span class="md-ellipsis">
      4. Firewall Evasion with Nmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-detecting-idsips-systems" class="md-nav__link">
    <span class="md-ellipsis">
      5. Detecting IDS/IPS Systems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-decoys-for-obfuscation" class="md-nav__link">
    <span class="md-ellipsis">
      6. Decoys for Obfuscation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scan-by-using-different-source-ip" class="md-nav__link">
    <span class="md-ellipsis">
      Scan by Using Different Source IP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dns-proxying" class="md-nav__link">
    <span class="md-ellipsis">
      DNS Proxying
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DNS Proxying">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#syn-scan-of-a-filtered-port" class="md-nav__link">
    <span class="md-ellipsis">
      SYN-Scan of a Filtered Port
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syn-scan-from-dns-port" class="md-nav__link">
    <span class="md-ellipsis">
      SYN-Scan From DNS Port
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-to-the-filtered-port" class="md-nav__link">
    <span class="md-ellipsis">
      Connect To The Filtered Port
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#study-tips" class="md-nav__link">
    <span class="md-ellipsis">
      Study Tips
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Nmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nmap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Service%20Enumeration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NSE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cheatsheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cheatsheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Host%20and%20Port%20Scanning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Host and Port Scanning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Saving%20the%20Result/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Saving the Result
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Performance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Performance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Nmap%20Host%20Discovery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nmap Host Discovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Attacking%20Network%20Services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attacking Network Services
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Info Gathering Web Edition
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Info Gathering Web Edition
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Info%20Gathering%20Web%20Edition/Penetration%20Testing%20Process/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Penetration Testing Process
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Footprinting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            Footprinting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/SNMP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SNMP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/NFS%20Network%20File%20System/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NFS Network File System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/SMTP%20Simple%20Mail%20Transfer%20Protocol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SMTP Simple Mail Transfer Protocol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/DNS%20Domain%20Name%20System/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/Domain%20Information/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domain Information
    
  </span>
  
    
  
  
    <span class="md-status md-status--['completed']"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/Cloud%20Resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud Resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/FTP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FTP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/MYSQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MYSQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/Windows%20Remote%20Management%20Protocols/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows Remote Management Protocols
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/Enumeration%20Methodology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enumeration Methodology
    
  </span>
  
    
  
  
    <span class="md-status md-status--['completed']"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/MSSQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MSSQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/Enumeration%20Principles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enumeration Principles
    
  </span>
  
    
  
  
    <span class="md-status md-status--['completed']"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/IMAP POP3.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/Linux%20Remote%20Management%20Protocols/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux Remote Management Protocols
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/Oracle%20-%20TNS%20Transparent%20Network%20Substate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Oracle - TNS Transparent Network Substate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/SMB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SMB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/IPMI Intelligent Platform Management Interface.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" >
        
          
          <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Skill Assessment
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            Skill Assessment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/Skill%20Assessment/Footprinting%20Lab%20-%20Hard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Footprinting Lab   Hard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/Skill%20Assessment/Footprinting_Lab_Meduim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Footprinting Lab Meduim
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Footprinting/Skill%20Assessment/Footprinting%20Lab%20-%20Easy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Footprinting Lab   Easy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" >
        
          
          <label class="md-nav__link" for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Vulnerability
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            Vulnerability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Vulnerability/Common%20Vulnerabilities%20and%20Exposures%20%28CVE%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common Vulnerabilities and Exposures (CVE)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Vulnerability/Common%20Vulnerability%20Scoring%20System%20%28CVSS%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common Vulnerability Scoring System (CVSS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Vulnerability/Assessment%20Standards/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assessment Standards
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Vulnerability/Getting%20Started%20with%20Nessus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started with Nessus
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Vulnerability/Vulnerability%20Assessment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerability Assessment
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    HTB
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            HTB
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Easy
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Easy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../HTB/easy/Blunder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blunder Walkthrough
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../HTB/easy/broadlight/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Broadlight
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../HTB/easy/busqueda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Busqueda
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../HTB/easy/sense/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sense
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../HTB/easy/postman/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Postman
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../HTB/easy/legacy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Legacy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../HTB/easy/Bashed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bashed
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../HTB/easy/Beep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beep
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../HTB/easy/Buff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Buff
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Meduim
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Meduim
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../HTB/meduim/active/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Active
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../HTB/meduim/jeeves/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jeeves
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hard
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Hard
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../HTB/hard/hard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hard
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#firewall-and-idsips-evasion-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      Firewall and IDS/IPS Evasion Techniques
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Firewall and IDS/IPS Evasion Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-understanding-firewalls" class="md-nav__link">
    <span class="md-ellipsis">
      1. Understanding Firewalls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-ids-vs-ips" class="md-nav__link">
    <span class="md-ellipsis">
      2. IDS vs. IPS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-identifying-firewalls-and-rules" class="md-nav__link">
    <span class="md-ellipsis">
      3. Identifying Firewalls and Rules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-firewall-evasion-with-nmap" class="md-nav__link">
    <span class="md-ellipsis">
      4. Firewall Evasion with Nmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-detecting-idsips-systems" class="md-nav__link">
    <span class="md-ellipsis">
      5. Detecting IDS/IPS Systems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-decoys-for-obfuscation" class="md-nav__link">
    <span class="md-ellipsis">
      6. Decoys for Obfuscation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scan-by-using-different-source-ip" class="md-nav__link">
    <span class="md-ellipsis">
      Scan by Using Different Source IP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dns-proxying" class="md-nav__link">
    <span class="md-ellipsis">
      DNS Proxying
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DNS Proxying">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#syn-scan-of-a-filtered-port" class="md-nav__link">
    <span class="md-ellipsis">
      SYN-Scan of a Filtered Port
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syn-scan-from-dns-port" class="md-nav__link">
    <span class="md-ellipsis">
      SYN-Scan From DNS Port
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-to-the-filtered-port" class="md-nav__link">
    <span class="md-ellipsis">
      Connect To The Filtered Port
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#study-tips" class="md-nav__link">
    <span class="md-ellipsis">
      Study Tips
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Firewall and IDS IPS Evasion</h1>

<h3 id="references">References</h3>
<ul>
<li><a href="https://example.com/tutorial">Example Tutorial</a></li>
<li><a href="https://documentation.oscp.org/exploitations">OSCP Exploit Documentation</a></li>
</ul>
<h3 id="firewall-and-idsips-evasion-techniques">Firewall and IDS/IPS Evasion Techniques</h3>
<h4 id="1-understanding-firewalls">1. <strong>Understanding Firewalls</strong></h4>
<ul>
<li><strong>Purpose</strong>: Prevents unauthorized external connections.</li>
<li><strong>Operation</strong>: Uses rules to monitor network traffic and decide whether to pass, ignore, or block packets.</li>
<li><strong>Packet Actions</strong>:<ul>
<li><strong>Drop</strong>: Packet is ignored, no response from the host.</li>
<li><strong>Reject</strong>: Host responds with an RST flag or ICMP error.</li>
</ul>
</li>
</ul>
<h4 id="2-ids-vs-ips">2. <strong>IDS vs. IPS</strong></h4>
<ul>
<li><strong>IDS (Intrusion Detection System)</strong>:<ul>
<li><strong>Function</strong>: Monitors for potential attacks, analyzing and reporting detected threats.</li>
<li><strong>Detection Method</strong>: Pattern matching and signature analysis.</li>
</ul>
</li>
<li><strong>IPS (Intrusion Prevention System)</strong>:<ul>
<li><strong>Function</strong>: Takes active measures against detected threats.</li>
<li><strong>Reaction</strong>: Blocks or modifies packets based on set rules.</li>
</ul>
</li>
<li><strong>Comparison to Firewalls</strong>: Unlike firewalls, IDS/IPS are passive and usually examine all traffic.</li>
</ul>
<h4 id="3-identifying-firewalls-and-rules">3. <strong>Identifying Firewalls and Rules</strong></h4>
<ul>
<li><strong>Filtered Ports</strong>: Could indicate firewall presence with specific rules.</li>
<li><strong>Response Types</strong>:<ul>
<li><strong>No response</strong>: Packet likely dropped.</li>
<li><strong>ICMP error/RST response</strong>: Indicates packet rejection.</li>
</ul>
</li>
</ul>
<h4 id="4-firewall-evasion-with-nmap">4. <strong>Firewall Evasion with Nmap</strong></h4>
<ul>
<li>
<p><strong>SYN Scan (-sS)</strong>:</p>
<ul>
<li>Useful for checking open or closed status.</li>
<li>Host responds with SYN-ACK for open ports, RST for closed.</li>
<li>
<p><strong>ACK Scan (-sA)</strong>:</p>
</li>
<li>
<p>Bypasses some firewalls; only sends ACK packets.</p>
</li>
<li>Hosts respond with RST for both open and closed ports.</li>
<li>Effective when SYN scans are blocked by firewalls.</li>
<li><strong>Example Command</strong>:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo<span class="w"> </span>nmap<span class="w"> </span><span class="o">[</span>target<span class="w"> </span>IP<span class="o">]</span><span class="w"> </span>-p<span class="w"> </span><span class="o">[</span>ports<span class="o">]</span><span class="w"> </span>-sS<span class="w"> </span>/<span class="w"> </span>-sA<span class="w"> </span>-Pn<span class="w"> </span>-n<span class="w"> </span>--disable-arp-ping<span class="w"> </span>--packet-trace
</code></pre></div>
</li>
</ul>
<h4 id="5-detecting-idsips-systems">5. <strong>Detecting IDS/IPS Systems</strong></h4>
<ul>
<li><strong>Active Detection</strong>: IDS only reports to admins, while IPS may block IPs.</li>
<li><strong>Testing</strong>:<ul>
<li>Use a VPS; if it gets blocked, assume IPS presence.</li>
<li>Switch to another IP if necessary, and reduce scan aggressiveness.</li>
</ul>
</li>
</ul>
<h4 id="6-decoys-for-obfuscation">6. <strong>Decoys for Obfuscation</strong></h4>
<ul>
<li>
<p><strong>Purpose</strong>: Hide the true source IP by adding random IPs as decoys.</p>
</li>
<li>
<p><strong>Usage</strong>:</p>
<ul>
<li>Use <code>-D</code> flag to add decoys; your real IP blends among others.</li>
<li>
<p>Example:</p>
<p>```shell
    sudo nmap [target IP] -p [ports] -sS -Pn -n --disable-arp-ping --packet-trace -D RND:[number of IPs]
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>- **Considerations**: Not all decoy IPs are guaranteed to work, as ISPs may filter spoofed packets.
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>#### 7. **Testing Firewall Rules with IP Manipulation**
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>- **Purpose**: See if altering the source IP affects access to certain services.
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>- **Commands**:
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    - Specifying Source IP: `-S [IP]`
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    - Operating System Detection: `-O` for guessing OS type.
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>---
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>#### **Common Commands**
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>1. **TCP SYN Scan**:
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>    ```shell
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>    sudo nmap &lt;target-IP&gt; -p &lt;ports&gt; -sS -Pn -n --disable-arp-ping --packet-trace
</code></pre></div></p>
</li>
</ul>
<p><strong>Description</strong>: Detects open ports by sending SYN packets. May trigger firewalls/IDS.
1. <strong>TCP ACK Scan</strong>:</p>
<p><code>shell
sudo nmap &lt;target-IP&gt; -p &lt;ports&gt; -sA -Pn -n --disable-arp-ping --packet-trace</code></p>
<ul>
<li><strong>Description</strong>: Bypasses some firewall rules; uses only ACK flag, triggering less strict filtering.</li>
</ul>
</li>
<li>
<p><strong>Decoy Scan</strong>:</p>
<p>```shell
sudo nmap <target-IP> -p <ports> -sS -Pn -n --disable-arp-ping --packet-trace -D RND:5
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>    - **Description**: Uses random IPs as decoys to mask the origin of the scan; helpful for evading IPS detection.
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>3. **Operating System Detection**:
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    ```shell
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    sudo nmap &lt;target-IP&gt; -n -Pn -p445 -O
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>    ```
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>    - **Description**: OS detection scan with specified port; can test for firewall rules.
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>4. **Specific Source IP (-S)**:
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>    ```shell
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>    sudo nmap &lt;target-IP&gt; -S &lt;spoofed-IP&gt; -p &lt;ports&gt; -Pn -n --packet-trace
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>    ```
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>    - **Description**: Masks actual IP by specifying a source IP, useful if certain subnets/IPs are blocked.
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>#### **Flag Definitions**
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>- `-Pn`: Disables ICMP Echo requests.
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>- `-n`: Disables DNS resolution.
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>- `--disable-arp-ping`: Disables ARP ping.
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>- `--packet-trace`: Shows packets sent/received.
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>- `-D &lt;IP(s)&gt;`: Adds decoy IPs.
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>- `-sS`: SYN scan.
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>- `-sA`: ACK scan.
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>---
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>#### Testing Firewall Rule
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>  Firewall and IDS/IPS Evasion
<a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>
<a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>```shell-session
<a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>0xs5@htb[/htb]$ sudo nmap 10.129.2.28 -n -Pn -p445 -O
<a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>
<a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-22 01:23 CEST
<a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>Nmap scan report for 10.129.2.28
<a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>Host is up (0.032s latency).
<a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a>
<a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a>PORT    STATE    SERVICE
<a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>445/tcp filtered microsoft-ds
<a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>MAC Address: DE:AD:00:00:BE:EF (Intel Corporate)
<a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a>Too many fingerprints match this host to give specific OS details
<a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a>Network Distance: 1 hop
<a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a>
<a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a>OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .
<a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>Nmap done: 1 IP address (1 host up) scanned in 3.14 seconds
</code></pre></div></p>
</li>
</ul>
<h4 id="scan-by-using-different-source-ip">Scan by Using Different Source IP</h4>
<p>Firewall and IDS/IPS Evasion</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>0xs5@htb<span class="o">[</span>/htb<span class="o">]</span>$<span class="w"> </span>sudo<span class="w"> </span>nmap<span class="w"> </span><span class="m">10</span>.129.2.28<span class="w"> </span>-n<span class="w"> </span>-Pn<span class="w"> </span>-p<span class="w"> </span><span class="m">445</span><span class="w"> </span>-O<span class="w"> </span>-S<span class="w"> </span><span class="m">10</span>.129.2.200<span class="w"> </span>-e<span class="w"> </span>tun0
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.80<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2020</span>-06-22<span class="w"> </span><span class="m">01</span>:16<span class="w"> </span>CEST
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.129.2.28
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.010s<span class="w"> </span>latency<span class="o">)</span>.
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>PORT<span class="w">    </span>STATE<span class="w"> </span>SERVICE
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="m">445</span>/tcp<span class="w"> </span>open<span class="w">  </span>microsoft-ds
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>MAC<span class="w"> </span>Address:<span class="w"> </span>DE:AD:00:00:BE:EF<span class="w"> </span><span class="o">(</span>Intel<span class="w"> </span>Corporate<span class="o">)</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>Warning:<span class="w"> </span>OSScan<span class="w"> </span>results<span class="w"> </span>may<span class="w"> </span>be<span class="w"> </span>unreliable<span class="w"> </span>because<span class="w"> </span>we<span class="w"> </span>could<span class="w"> </span>not<span class="w"> </span>find<span class="w"> </span>at<span class="w"> </span>least<span class="w"> </span><span class="m">1</span><span class="w"> </span>open<span class="w"> </span>and<span class="w"> </span><span class="m">1</span><span class="w"> </span>closed<span class="w"> </span>port
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>Aggressive<span class="w"> </span>OS<span class="w"> </span>guesses:<span class="w"> </span>Linux<span class="w"> </span><span class="m">2</span>.6.32<span class="w"> </span><span class="o">(</span><span class="m">96</span>%<span class="o">)</span>,<span class="w"> </span>Linux<span class="w"> </span><span class="m">3</span>.2<span class="w"> </span>-<span class="w"> </span><span class="m">4</span>.9<span class="w"> </span><span class="o">(</span><span class="m">96</span>%<span class="o">)</span>,<span class="w"> </span>Linux<span class="w"> </span><span class="m">2</span>.6.32<span class="w"> </span>-<span class="w"> </span><span class="m">3</span>.10<span class="w"> </span><span class="o">(</span><span class="m">96</span>%<span class="o">)</span>,<span class="w"> </span>Linux<span class="w"> </span><span class="m">3</span>.4<span class="w"> </span>-<span class="w"> </span><span class="m">3</span>.10<span class="w"> </span><span class="o">(</span><span class="m">95</span>%<span class="o">)</span>,<span class="w"> </span>Linux<span class="w"> </span><span class="m">3</span>.1<span class="w"> </span><span class="o">(</span><span class="m">95</span>%<span class="o">)</span>,<span class="w"> </span>Linux<span class="w"> </span><span class="m">3</span>.2<span class="w"> </span><span class="o">(</span><span class="m">95</span>%<span class="o">)</span>,<span class="w"> </span>AXIS<span class="w"> </span>210A<span class="w"> </span>or<span class="w"> </span><span class="m">211</span><span class="w"> </span>Network<span class="w"> </span>Camera<span class="w"> </span><span class="o">(</span>Linux<span class="w"> </span><span class="m">2</span>.6.17<span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="m">94</span>%<span class="o">)</span>,<span class="w"> </span>Synology<span class="w"> </span>DiskStation<span class="w"> </span>Manager<span class="w"> </span><span class="m">5</span>.2-5644<span class="w"> </span><span class="o">(</span><span class="m">94</span>%<span class="o">)</span>,<span class="w"> </span>Linux<span class="w"> </span><span class="m">2</span>.6.32<span class="w"> </span>-<span class="w"> </span><span class="m">2</span>.6.35<span class="w"> </span><span class="o">(</span><span class="m">94</span>%<span class="o">)</span>,<span class="w"> </span>Linux<span class="w"> </span><span class="m">2</span>.6.32<span class="w"> </span>-<span class="w"> </span><span class="m">3</span>.5<span class="w"> </span><span class="o">(</span><span class="m">94</span>%<span class="o">)</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>No<span class="w"> </span>exact<span class="w"> </span>OS<span class="w"> </span>matches<span class="w"> </span><span class="k">for</span><span class="w"> </span>host<span class="w"> </span><span class="o">(</span><span class="nb">test</span><span class="w"> </span>conditions<span class="w"> </span>non-ideal<span class="o">)</span>.
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>Network<span class="w"> </span>Distance:<span class="w"> </span><span class="m">1</span><span class="w"> </span>hop
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>OS<span class="w"> </span>detection<span class="w"> </span>performed.<span class="w"> </span>Please<span class="w"> </span>report<span class="w"> </span>any<span class="w"> </span>incorrect<span class="w"> </span>results<span class="w"> </span>at<span class="w"> </span>https://nmap.org/submit/<span class="w"> </span>.
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">4</span>.11<span class="w"> </span>seconds
</code></pre></div>
<table>
<thead>
<tr>
<th><strong>Scanning Options</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>10.129.2.28</code></td>
<td>Scans the specified target.</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>Disables DNS resolution.</td>
</tr>
<tr>
<td><code>-Pn</code></td>
<td>Disables ICMP Echo requests.</td>
</tr>
<tr>
<td><code>-p 445</code></td>
<td>Scans only the specified ports.</td>
</tr>
<tr>
<td><code>-O</code></td>
<td>Performs operation system detection scan.</td>
</tr>
<tr>
<td><code>-S</code></td>
<td>Scans the target by using different source IP address.</td>
</tr>
<tr>
<td><code>10.129.2.200</code></td>
<td>Specifies the source IP address.</td>
</tr>
<tr>
<td><code>-e tun0</code></td>
<td>Sends all requests through the specified interface.</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="dns-proxying">DNS Proxying</h2>
<p>By default, <code>Nmap</code> performs a reverse DNS resolution unless otherwise specified to find more important information about our target. These DNS queries are also passed in most cases because the given web server is supposed to be found and visited. The DNS queries are made over the <code>UDP port 53</code>. The <code>TCP port 53</code> was previously only used for the so-called "<code>Zone transfers</code>" between the DNS servers or data transfer larger than 512 bytes. More and more, this is changing due to IPv6 and DNSSEC expansions. These changes cause many DNS requests to be made via TCP port 53.</p>
<p>However, <code>Nmap</code> still gives us a way to specify DNS servers ourselves (<code>--dns-server &lt;ns&gt;,&lt;ns&gt;</code>). This method could be fundamental to us if we are in a demilitarized zone (<code>DMZ</code>). The company's DNS servers are usually more trusted than those from the Internet. So, for example, we could use them to interact with the hosts of the internal network. As another example, we can use <code>TCP port 53</code> as a source port (<code>--source-port</code>) for our scans. If the administrator uses the firewall to control this port and does not filter IDS/IPS properly, our TCP packets will be trusted and passed through.</p>
<h4 id="syn-scan-of-a-filtered-port">SYN-Scan of a Filtered Port</h4>
<p>Firewall and IDS/IPS Evasion</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>0xs5@htb<span class="o">[</span>/htb<span class="o">]</span>$<span class="w"> </span>sudo<span class="w"> </span>nmap<span class="w"> </span><span class="m">10</span>.129.2.28<span class="w"> </span>-p50000<span class="w"> </span>-sS<span class="w"> </span>-Pn<span class="w"> </span>-n<span class="w"> </span>--disable-arp-ping<span class="w"> </span>--packet-trace
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.80<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2020</span>-06-21<span class="w"> </span><span class="m">22</span>:50<span class="w"> </span>CEST
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>SENT<span class="w"> </span><span class="o">(</span><span class="m">0</span>.0417s<span class="o">)</span><span class="w"> </span>TCP<span class="w"> </span><span class="m">10</span>.10.14.2:33436<span class="w"> </span>&gt;<span class="w"> </span><span class="m">10</span>.129.2.28:50000<span class="w"> </span>S<span class="w"> </span><span class="nv">ttl</span><span class="o">=</span><span class="m">41</span><span class="w"> </span><span class="nv">id</span><span class="o">=</span><span class="m">21939</span><span class="w"> </span><span class="nv">iplen</span><span class="o">=</span><span class="m">44</span><span class="w">  </span><span class="nv">seq</span><span class="o">=</span><span class="m">736533153</span><span class="w"> </span><span class="nv">win</span><span class="o">=</span><span class="m">1024</span><span class="w"> </span>&lt;mss<span class="w"> </span><span class="m">1460</span>&gt;
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>SENT<span class="w"> </span><span class="o">(</span><span class="m">1</span>.0481s<span class="o">)</span><span class="w"> </span>TCP<span class="w"> </span><span class="m">10</span>.10.14.2:33437<span class="w"> </span>&gt;<span class="w"> </span><span class="m">10</span>.129.2.28:50000<span class="w"> </span>S<span class="w"> </span><span class="nv">ttl</span><span class="o">=</span><span class="m">46</span><span class="w"> </span><span class="nv">id</span><span class="o">=</span><span class="m">6446</span><span class="w"> </span><span class="nv">iplen</span><span class="o">=</span><span class="m">44</span><span class="w">  </span><span class="nv">seq</span><span class="o">=</span><span class="m">736598688</span><span class="w"> </span><span class="nv">win</span><span class="o">=</span><span class="m">1024</span><span class="w"> </span>&lt;mss<span class="w"> </span><span class="m">1460</span>&gt;
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.129.2.28
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>Host<span class="w"> </span>is<span class="w"> </span>up.
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>PORT<span class="w">      </span>STATE<span class="w">    </span>SERVICE
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="m">50000</span>/tcp<span class="w"> </span>filtered<span class="w"> </span>ibm-db2
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">2</span>.06<span class="w"> </span>seconds
</code></pre></div>
<h4 id="syn-scan-from-dns-port">SYN-Scan From DNS Port</h4>
<p>Firewall and IDS/IPS Evasion</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>0xs5@htb<span class="o">[</span>/htb<span class="o">]</span>$<span class="w"> </span>sudo<span class="w"> </span>nmap<span class="w"> </span><span class="m">10</span>.129.2.28<span class="w"> </span>-p50000<span class="w"> </span>-sS<span class="w"> </span>-Pn<span class="w"> </span>-n<span class="w"> </span>--disable-arp-ping<span class="w"> </span>--packet-trace<span class="w"> </span>--source-port<span class="w"> </span><span class="m">53</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>SENT<span class="w"> </span><span class="o">(</span><span class="m">0</span>.0482s<span class="o">)</span><span class="w"> </span>TCP<span class="w"> </span><span class="m">10</span>.10.14.2:53<span class="w"> </span>&gt;<span class="w"> </span><span class="m">10</span>.129.2.28:50000<span class="w"> </span>S<span class="w"> </span><span class="nv">ttl</span><span class="o">=</span><span class="m">58</span><span class="w"> </span><span class="nv">id</span><span class="o">=</span><span class="m">27470</span><span class="w"> </span><span class="nv">iplen</span><span class="o">=</span><span class="m">44</span><span class="w">  </span><span class="nv">seq</span><span class="o">=</span><span class="m">4003923435</span><span class="w"> </span><span class="nv">win</span><span class="o">=</span><span class="m">1024</span><span class="w"> </span>&lt;mss<span class="w"> </span><span class="m">1460</span>&gt;
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>RCVD<span class="w"> </span><span class="o">(</span><span class="m">0</span>.0608s<span class="o">)</span><span class="w"> </span>TCP<span class="w"> </span><span class="m">10</span>.129.2.28:50000<span class="w"> </span>&gt;<span class="w"> </span><span class="m">10</span>.10.14.2:53<span class="w"> </span>SA<span class="w"> </span><span class="nv">ttl</span><span class="o">=</span><span class="m">64</span><span class="w"> </span><span class="nv">id</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">iplen</span><span class="o">=</span><span class="m">44</span><span class="w">  </span><span class="nv">seq</span><span class="o">=</span><span class="m">540635485</span><span class="w"> </span><span class="nv">win</span><span class="o">=</span><span class="m">64240</span><span class="w"> </span>&lt;mss<span class="w"> </span><span class="m">1460</span>&gt;
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.129.2.28
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.013s<span class="w"> </span>latency<span class="o">)</span>.
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>PORT<span class="w">      </span>STATE<span class="w"> </span>SERVICE
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="m">50000</span>/tcp<span class="w"> </span>open<span class="w">  </span>ibm-db2
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>MAC<span class="w"> </span>Address:<span class="w"> </span>DE:AD:00:00:BE:EF<span class="w"> </span><span class="o">(</span>Intel<span class="w"> </span>Corporate<span class="o">)</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span>.08<span class="w"> </span>seconds
</code></pre></div>
<table>
<thead>
<tr>
<th><strong>Scanning Options</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>10.129.2.28</code></td>
<td>Scans the specified target.</td>
</tr>
<tr>
<td><code>-p 50000</code></td>
<td>Scans only the specified ports.</td>
</tr>
<tr>
<td><code>-sS</code></td>
<td>Performs SYN scan on specified ports.</td>
</tr>
<tr>
<td><code>-Pn</code></td>
<td>Disables ICMP Echo requests.</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>Disables DNS resolution.</td>
</tr>
<tr>
<td><code>--disable-arp-ping</code></td>
<td>Disables ARP ping.</td>
</tr>
<tr>
<td><code>--packet-trace</code></td>
<td>Shows all packets sent and received.</td>
</tr>
<tr>
<td><code>--source-port 53</code></td>
<td>Performs the scans from specified source port.</td>
</tr>
</tbody>
</table>
<hr />
<p>Now that we have found out that the firewall accepts <code>TCP port 53</code>, it is very likely that IDS/IPS filters might also be configured much weaker than others. We can test this by trying to connect to this port by using <code>Netcat</code>.</p>
<h4 id="connect-to-the-filtered-port">Connect To The Filtered Port</h4>
<p>Firewall and IDS/IPS Evasion</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>0xs5@htb<span class="o">[</span>/htb<span class="o">]</span>$<span class="w"> </span>ncat<span class="w"> </span>-nv<span class="w"> </span>--source-port<span class="w"> </span><span class="m">53</span><span class="w"> </span><span class="m">10</span>.129.2.28<span class="w"> </span><span class="m">50000</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>Ncat:<span class="w"> </span>Version<span class="w"> </span><span class="m">7</span>.80<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org/ncat<span class="w"> </span><span class="o">)</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>Ncat:<span class="w"> </span>Connected<span class="w"> </span>to<span class="w"> </span><span class="m">10</span>.129.2.28:50000.
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="m">220</span><span class="w"> </span>ProFTPd
</code></pre></div>
<hr />
<h3 id="study-tips">Study Tips</h3>
<ol>
<li><strong>Practice Commands</strong>: Get hands-on with Nmap’s evasion options; understanding their output will help solidify the concepts.</li>
<li><strong>Flashcards</strong>: Make flashcards for key commands and flags (<code>-sS</code>, <code>-sA</code>, <code>-D</code>, <code>--packet-trace</code>, etc.) to reinforce learning.</li>
<li><strong>Simulate Scenarios</strong>: Set up small network labs with virtual machines to practice firewall/IDS/IPS detection and evasion.</li>
<li><strong>Review Response Codes</strong>: Recognize common ICMP error codes and TCP flags (RST, SYN-ACK) and their implications.</li>
<li><strong>Time Management</strong>: In the exam, prioritize evasion techniques if scans are blocked, and practice adjusting strategies on-the-fly.</li>
</ol>
<p><strong>Next Lesson</strong> [[Firewall and IDs and IPs Evasion Labs]]</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.annotation", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>